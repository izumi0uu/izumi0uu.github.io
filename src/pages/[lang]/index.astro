---
import { Image } from "astro:assets";

import { getPageMetadata } from "@/utils/content/metadata";
import { cn } from "@/utils/ui/styles";
import * as m from "@/paraglide/messages";
import { getPathWithLocale } from "@/utils/routing/paths";

import { SUPPORTED_LOCALES } from "@/config/i18n";
import { CONFIG_CLIENT } from "@/config/client";
import { ROUTES } from "@/constants/routes";
import { Mail, Github, Twitter, Linkedin } from "lucide-react";
import heroImage from "@/assets/images/hero-default.png";

import Centered from "@/layouts/Centered.astro";

import { FallingText } from "@/components/react/ui/FallingText";
import { Link } from "@/components/react/ui/Link";
import { Separator } from "@/components/react/radix-ui/Separator";
import { HeroContactLinks } from "@/components/react/app/home/HeroContactLinks";
import { HeroBanner } from "@/components/react/app/home/HeroBanner";
import { QuickLinksSection } from "@/components/react/app/home/QuickLinksSection";

export async function getStaticPaths() {
  return SUPPORTED_LOCALES.map((lang) => ({
    params: { lang },
  }));
}

const { lang } = Astro.params;

// 获取页面metadata（使用空字符串作为首页的key）
const metadata = getPageMetadata("");

const fallingText = m["pages.home.falling_text"]();

const blogPath = getPathWithLocale(ROUTES.BLOG);

const quickLinks = [
  { name: "Blog", href: getPathWithLocale(ROUTES.BLOG), icon: "↗" },
  { name: "Explore", href: getPathWithLocale(ROUTES.EXPLORE), icon: "↗" },
  { name: "Projects", href: getPathWithLocale(ROUTES.PROJECTS), icon: "↗" },
  { name: "About", href: getPathWithLocale(ROUTES.ABOUT), icon: "↗" },
  { name: "Contact", href: getPathWithLocale(ROUTES.CONTACT), icon: "↗" },
];

const socialLinks = {
  email: CONFIG_CLIENT.AUTHOR_EMAIL,
  github: CONFIG_CLIENT.AUTHOR_GITHUB,
  twitter: CONFIG_CLIENT.AUTHOR_TWITTER,
  linkedin: CONFIG_CLIENT.AUTHOR_LINKEDIN,
};
---

<!-- TODO: FIX i18n -->
<Centered {metadata} className="flex-col-layout gap-16 first:gap-0">
  <!-- Hero Page Section -->
  <section
    id="hero-page-section"
    aria-label="hero-page"
    class="flex-col-layout mode-theme-switch bg-surface-container rounded-sm"
  >
    <div
      id="hero-page"
      aria-label="hero-page"
      class="grid grid-cols-1 lg:grid-cols-2 gap-8 p-4 min-h-[60vh] items-center"
    >
      <div id="hero-page-content" class="flex flex-col gap-4">
        <HeroBanner blogPath={blogPath} client:only="react" />
        <HeroContactLinks socialLinks={socialLinks} client:only="react" />
      </div>
      <div
        id="hero-page-image"
        aria-label="hero-page-image"
        class="hidden lg:flex items-center justify-center w-full h-full max-w-md max-h-[500px] mx-auto"
      >
        <Image
          src={heroImage}
          alt="Hero page illustration"
          width={400}
          height={500}
          class="w-full h-auto object-contain rounded-lg shadow-lg"
          loading="eager"
          decoding="async"
        />
      </div>
    </div>
  </section>

  <!-- Quick Links Section -->
  <QuickLinksSection links={quickLinks} client:only="react" />

  <!-- Falling Text Section -->
  <section
    id="falling-text"
    aria-label="falling-text"
    class={cn("flex justify-center items-center h-[30vh] w-full")}
  >
    <FallingText
      text={m["pages.home.falling_text"]()}
      highlightWords={["ideas", "share"]}
      highlightClass="highlighted"
      trigger="hover"
      wireframes={false}
      gravity={0.3}
      fontSize="2rem"
      mouseConstraintStiffness={0.9}
      client:only="react"
    />
  </section>

  <!-- TODO: Blog Preview Section -->
  <!-- Blogs Section -->
  <section
    id="blogs-preview"
    aria-label="blogs-preview"
    class={cn("flex-col-layout mode-theme-switch bg-surface-container")}
  >
  </section>

  <!-- TODO: Projects Preview Section -->
  <!-- Projects Section -->
  <section
    id="projects-preview"
    aria-label="projects-preview"
    class={cn("flex-col-layout mode-theme-switch bg-surface-container")}
  >
  </section>
</Centered>
